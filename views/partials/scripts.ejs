<% const pageJs = (typeof extraJs !== 'undefined' && Array.isArray(extraJs))
  ? extraJs
  : (locals && Array.isArray(locals.extraJs) ? locals.extraJs : []); %>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js" defer></script>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    if (window.AOS) {
      AOS.init({ once: true, duration: 800, easing: 'ease-out-cubic', offset: 100 });
    }

    const nav = document.querySelector('.navbar');
    if (nav) window.addEventListener('scroll', () => nav.classList.toggle('scrolled', window.scrollY > 50));

    const logoIcon = document.querySelector('.logo i');
    const navMenu = document.getElementById('navMenu');
    if (!navMenu) return;

    let menuOverlay = document.querySelector('.menu-overlay');
    if (!menuOverlay) {
      menuOverlay = document.createElement('div');
      menuOverlay.className = 'menu-overlay';
      document.body.appendChild(menuOverlay);
    }
    let isMenuOpen = false;

    function toggleMenu() {
      isMenuOpen = !isMenuOpen;
      navMenu && navMenu.classList.toggle('active');
      menuOverlay.classList.toggle('active');
      document.body.classList.toggle('menu-open');
      if (logoIcon) {
        logoIcon.style.transform = isMenuOpen ? 'rotate(90deg)' : 'rotate(0deg)';
      }
    }

    const handleMenuToggle = (e) => {
      if (window.innerWidth <= 992) {
        e.preventDefault();
        e.stopPropagation();
        toggleMenu();
      }
    };

    const toggleTarget = document.getElementById('botonMenu') || logoIcon;
    if (toggleTarget) {
      toggleTarget.addEventListener('click', handleMenuToggle);
      toggleTarget.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') handleMenuToggle(e);
      });
    }

    menuOverlay.addEventListener('click', () => {
      if (window.innerWidth <= 992 && isMenuOpen) toggleMenu();
    });

    const navLinks = document.querySelectorAll('.nav-link');
    navLinks.forEach(link => link.addEventListener('click', () => {
      if (window.innerWidth <= 992 && isMenuOpen) toggleMenu();
    }));

    window.addEventListener('resize', () => {
      if (window.innerWidth > 992 && isMenuOpen) toggleMenu();
    });
  });
</script>

<% if (pageJs.length) { pageJs.forEach(function(src) { %>
  <script src="<%= src %>" defer></script>
<% }) } %>
